<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Police CAD System</title>
<!-- Leaflet.js for map -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<style>
  body { margin: 0; font-family: Arial, sans-serif; display: flex; height: 100vh; }
  #sidebar { width: 300px; background: #2c3e50; color: white; display: flex; flex-direction: column; padding: 10px; box-sizing: border-box; }
  #sidebar h2 { margin-top: 0; }
  #sidebar button { margin: 5px 0; padding: 10px; border: none; background: #34495e; color: white; cursor: pointer; }
  #sidebar button:hover { background: #1abc9c; }
  #main { flex: 1; display: flex; flex-direction: column; }
  #calls, #units, #bolos { flex: 1; overflow-y: auto; padding: 10px; border-bottom: 1px solid #ccc; }
  table { width: 100%; border-collapse: collapse; }
  th, td { border: 1px solid #ccc; padding: 5px; text-align: left; }
  #map { flex: 2; }
</style>
</head>
<body>

<div id="sidebar">
  <h2>Police CAD</h2>
  <button onclick="showSection('calls')">Calls</button>
  <button onclick="showSection('units')">Units</button>
  <button onclick="showSection('bolos')">BOLOs</button>
</div>

<div id="main">
  <div id="calls">
    <h3>Active Calls</h3>
    <button onclick="addCall()">Add Call</button>
    <table id="callsTable">
      <thead><tr><th>ID</th><th>Type</th><th>Location</th><th>Status</th><th>Assign</th><th>Action</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="units" style="display:none;">
    <h3>Units</h3>
    <table id="unitsTable">
      <thead><tr><th>ID</th><th>Name</th><th>Status</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="bolos" style="display:none;">
    <h3>BOLOs / Warrants</h3>
    <button onclick="addBolo()">Add BOLO</button>
    <table id="bolosTable">
      <thead><tr><th>ID</th><th>Description</th><th>Status</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="map"></div>
</div>

<script>
// Sections
function showSection(section) {
  document.getElementById('calls').style.display = 'none';
  document.getElementById('units').style.display = 'none';
  document.getElementById('bolos').style.display = 'none';
  document.getElementById(section).style.display = 'block';
}

// Sample data
let calls = [];
let units = [
  {id: 1, name: 'Unit 1', status: 'Available'},
  {id: 2, name: 'Unit 2', status: 'Available'}
];
let bolos = [];

const map = L.map('map').setView([39.7684, -86.1581], 12); // Indianapolis default
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: 'Â© OpenStreetMap contributors' }).addTo(map);

// Functions
function addCall() {
  const type = prompt("Enter call type (e.g., Traffic Stop, 911):");
  const location = prompt("Enter location:");
  if(!type || !location) return;
  const id = calls.length + 1;
  calls.push({id, type, location, status: 'Dispatched', assigned: ''});
  renderCalls();
}

function assignUnit(callId) {
  const unitId = prompt("Enter Unit ID to assign:");
  const unit = units.find(u => u.id == unitId);
  if(unit) {
    const call = calls.find(c => c.id == callId);
    call.assigned = unit.name;
    call.status = 'En Route';
    unit.status = 'Busy';
    renderUnits();
    renderCalls();
  }
}

function closeCall(callId) {
  const call = calls.find(c => c.id == callId);
  call.status = 'Closed';
  const unit = units.find(u => u.name === call.assigned);
  if(unit) unit.status = 'Available';
  renderUnits();
  renderCalls();
}

function renderCalls() {
  const tbody = document.querySelector('#callsTable tbody');
  tbody.innerHTML = '';
  calls.forEach(c => {
    const row = document.createElement('tr');
    row.innerHTML = `<td>${c.id}</td><td>${c.type}</td><td>${c.location}</td><td>${c.status}</td>
    <td>${c.assigned || '<button onclick="assignUnit('+c.id+')">Assign</button>'}</td>
    <td><button onclick="closeCall(${c.id})">Close</button></td>`;
    tbody.appendChild(row);
  });
}

function renderUnits() {
  const tbody = document.querySelector('#unitsTable tbody');
  tbody.innerHTML = '';
  units.forEach(u => {
    const row = document.createElement('tr');
    row.innerHTML = `<td>${u.id}</td><td>${u.name}</td><td>${u.status}</td>`;
    tbody.appendChild(row);
  });
}

function addBolo() {
  const description = prompt("Enter BOLO/Warrant description:");
  if(!description) return;
  const id = bolos.length + 1;
  bolos.push({id, description, status: 'Active'});
  renderBolos();
}

function renderBolos() {
  const tbody = document.querySelector('#bolosTable tbody');
  tbody.innerHTML = '';
  bolos.forEach(b => {
    const row = document.createElement('tr');
    row.innerHTML = `<td>${b.id}</td><td>${b.description}</td><td>${b.status}</td>`;
    tbody.appendChild(row);
  });
}

// Initial render
renderCalls();
renderUnits();
renderBolos();
</script>

</body>
</html>
