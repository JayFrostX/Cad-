<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Rockford City Police CAD</title>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>

<style>
:root {
  --bg:#0f1720;
  --panel:#1f2a38;
  --text:white;
  --table:white;
}

.light {
  --bg:#f4f4f4;
  --panel:white;
  --text:black;
  --table:white;
}

body {
  margin:0;
  font-family:Arial;
  background:var(--bg);
  color:var(--text);
}

/* ================= BOOT SCREEN ================= */

#bootScreen {
  position:fixed;
  width:100%;
  height:100vh;
  background:linear-gradient(to right, #6ea0c9, #5c8fbb);
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:9999;
  transition:opacity 0.5s ease;
}

.bootContainer { text-align:center; }

.progressBar {
  width:500px;
  height:45px;
  border-radius:12px;
  border:3px solid #4e79a7;
  padding:6px;
  margin-bottom:20px;
}

.progressFill {
  height:100%;
  width:0%;
  background:#3d6ea5;
  border-radius:8px;
  transition:width 0.2s ease;
}

.bootText {
  font-size:28px;
  font-weight:bold;
  color:#3d6ea5;
  letter-spacing:2px;
}

/* ================= LOGIN SCREEN ================= */

#loginPage {
  height:100vh;
  background:#0b2a57;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  animation:fadeIn 0.8s ease-in-out;
}

.loginHeader {
  position:absolute;
  top:40px;
  text-align:center;
  color:white;
}

.loginHeader h1 {
  margin:0;
  font-size:30px;
  letter-spacing:2px;
}

.loginHeader p {
  margin-top:5px;
  font-size:14px;
  opacity:0.9;
}

#loginBox {
  background:#d9d9d9;
  padding:35px 40px;
  width:420px;
  border-radius:4px;
  box-shadow:0 0 30px rgba(0,0,0,0.5);
  text-align:left;
  animation:slideUp 0.5s ease;
}

.badge {
  width:90px;
  height:110px;
  margin:0 auto 15px auto;
  background:gold;
  clip-path: polygon(50% 0%, 85% 20%, 100% 60%, 50% 100%, 0% 60%, 15% 20%);
  border:4px solid #b8860b;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  font-weight:bold;
  color:black;
  box-shadow:0 0 12px gold;
  text-align:center;
}

.badge span { font-size:11px; }

#loginBox h2 {
  text-align:center;
  margin-bottom:20px;
  color:black;
}

#loginBox label {
  font-weight:bold;
  font-size:14px;
  color:black;
}

#loginBox input {
  width:100%;
  padding:10px;
  margin:6px 0 15px 0;
  border:1px solid #aaa;
  border-radius:3px;
  font-size:14px;
}

#loginBox button {
  width:100%;
  padding:10px;
  background:#2f4f9e;
  color:white;
  border:none;
  border-radius:3px;
  cursor:pointer;
  font-weight:bold;
}

#loginBox button:hover { background:#1f3c7a; }

@keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
@keyframes slideUp { from{transform:translateY(25px);opacity:0;} to{transform:translateY(0);opacity:1;} }

/* ================= CAD SYSTEM ================= */

#cadSystem { display:none; height:100vh; display:flex; }

#sidebar {
  width:260px;
  background:var(--panel);
  padding:15px;
}

#main { flex:1; display:flex; flex-direction:column; }

.section {
  flex:1;
  overflow:auto;
  padding:10px;
  display:none;
}

.section.active { display:block; }

table {
  width:100%;
  border-collapse:collapse;
  background:var(--table);
  color:black;
}

th, td {
  border:1px solid #ccc;
  padding:6px;
}

.deleteBtn {
  background:red;
  color:white;
  padding:4px 8px;
  cursor:pointer;
}

#chatContainer {
  height:40%;
  display:flex;
  flex-direction:column;
  border-top:2px solid #ccc;
}

#messages {
  flex:1;
  overflow-y:auto;
  padding:10px;
  background:#ddd;
  color:black;
}

#chatInputArea { display:flex; }
#chatInput { flex:1; }
</style>
</head>

<body>

<!-- BOOT SCREEN -->
<div id="bootScreen">
  <div class="bootContainer">
    <div class="progressBar">
      <div class="progressFill" id="progressFill"></div>
    </div>
    <div class="bootText">STARTING...</div>
  </div>
</div>

<!-- LOGIN -->
<div id="loginPage">
  <div class="loginHeader">
    <h1>ROCKFORD CITY POLICE DEPT</h1>
    <p>Protecting Rockford City</p>
  </div>

  <div id="loginBox">
    <div class="badge">
      <div>ROCKFORD</div>
      <span>POLICE</span>
      <span>CITY</span>
    </div>

    <h2>Secure Terminal Access</h2>

    <label>Username:</label>
    <input id="loginUser" autocomplete="off">

    <label>Password:</label>
    <input type="password" id="loginPass">

    <button onclick="login()">Login</button>
  </div>
</div>

<!-- CAD -->
<div id="cadSystem">
  <div id="sidebar">
    <h3>Rockford City</h3>
    <button onclick="showSection('calls')">Calls</button>
    <button onclick="showSection('units')">Units</button>
    <button onclick="showSection('warrants')">Warrants</button>
    <button onclick="showSection('arrests')">Arrests</button>
    <button onclick="toggleTheme()">Toggle Dark/Light</button>
  </div>

  <div id="main">

    <div id="calls" class="section active">
      <h3>Calls</h3>
      <button onclick="addCall()">Add</button>
      <table>
        <thead>
          <tr><th>ID</th><th>Type</th><th>Location</th><th>Delete</th></tr>
        </thead>
        <tbody id="callsBody"></tbody>
      </table>
    </div>

    <div id="units" class="section">
      <h3>Units</h3>
      <button onclick="addUnit()">Add</button>
      <table>
        <thead>
          <tr><th>ID</th><th>Name</th><th>Delete</th></tr>
        </thead>
        <tbody id="unitsBody"></tbody>
      </table>
    </div>

    <div id="warrants" class="section">
      <h3>Warrants</h3>
      <button onclick="addWarrant()">Add</button>
      <table>
        <thead>
          <tr><th>ID</th><th>Name</th><th>Reason</th><th>Delete</th></tr>
        </thead>
        <tbody id="warrantsBody"></tbody>
      </table>
    </div>

    <div id="arrests" class="section">
      <h3>Arrests</h3>
      <button onclick="addArrest()">Add</button>
      <table>
        <thead>
          <tr><th>ID</th><th>Name</th><th>Reason</th><th>Delete</th></tr>
        </thead>
        <tbody id="arrestsBody"></tbody>
      </table>
    </div>

    <div id="chatContainer">
      <div id="messages"></div>
      <div id="chatInputArea">
        <input id="chatInput" placeholder="Message...">
        <button onclick="sendMessage()">Send</button>
      </div>
    </div>

  </div>
</div>

<script>

/* ================= BOOT SEQUENCE ================= */

window.onload = function(){
  const fill = document.getElementById("progressFill");
  let width = 0;

  const interval = setInterval(() => {
    width += 10;
    fill.style.width = width + "%";

    if(width >= 100){
      clearInterval(interval);
      setTimeout(() => {
        document.getElementById("bootScreen").style.opacity = "0";
        setTimeout(()=>{
          document.getElementById("bootScreen").style.display = "none";
        },500);
      },400);
    }
  },200);
};

/* FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "YOUR_KEY_HERE"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* LOGIN */
let currentUser = "";

function login(){
  const user = document.getElementById("loginUser").value.trim();
  currentUser = user || "Officer";

  document.getElementById("loginPage").style.display="none";
  document.getElementById("cadSystem").style.display="flex";
}

document.addEventListener("keydown", function(e){
  if(e.key==="Enter" && document.getElementById("loginPage").style.display!=="none"){
    login();
  }
});

/* THEME */
function toggleTheme(){ document.body.classList.toggle("light"); }

/* SECTIONS */
function showSection(id){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

/* DELETE */
function deleteItem(array,id,render){
  const i=array.findIndex(x=>x.id===id);
  if(i>-1){array.splice(i,1);render();}
}

/* CALLS */
let calls=[];
function addCall(){
  const type=prompt("Type:");
  const loc=prompt("Location:");
  if(!type||!loc)return;
  calls.push({id:Date.now(),type,loc});
  renderCalls();
}
function renderCalls(){
  callsBody.innerHTML="";
  calls.forEach(c=>{
    callsBody.innerHTML+=`
    <tr>
      <td>${c.id}</td>
      <td>${c.type}</td>
      <td>${c.loc}</td>
      <td><button class="deleteBtn" onclick="deleteItem(calls,${c.id},renderCalls)">X</button></td>
    </tr>`;
  });
}

/* UNITS */
let units=[];
function addUnit(){
  const name=prompt("Name:");
  if(!name)return;
  units.push({id:Date.now(),name});
  renderUnits();
}
function renderUnits(){
  unitsBody.innerHTML="";
  units.forEach(u=>{
    unitsBody.innerHTML+=`
    <tr>
      <td>${u.id}</td>
      <td>${u.name}</td>
      <td><button class="deleteBtn" onclick="deleteItem(units,${u.id},renderUnits)">X</button></td>
    </tr>`;
  });
}

/* WARRANTS */
let warrants=[];
function addWarrant(){
  const name=prompt("Name:");
  const reason=prompt("Reason:");
  if(!name||!reason)return;
  warrants.push({id:Date.now(),name,reason});
  renderWarrants();
}
function renderWarrants(){
  warrantsBody.innerHTML="";
  warrants.forEach(w=>{
    warrantsBody.innerHTML+=`
    <tr>
      <td>${w.id}</td>
      <td>${w.name}</td>
      <td>${w.reason}</td>
      <td><button class="deleteBtn" onclick="deleteItem(warrants,${w.id},renderWarrants)">X</button></td>
    </tr>`;
  });
}

/* ARRESTS */
let arrests=[];
function addArrest(){
  const name=prompt("Name:");
  const reason=prompt("Reason:");
  if(!name||!reason)return;
  arrests.push({id:Date.now(),name,reason});
  renderArrests();
}
function renderArrests(){
  arrestsBody.innerHTML="";
  arrests.forEach(a=>{
    arrestsBody.innerHTML+=`
    <tr>
      <td>${a.id}</td>
      <td>${a.name}</td>
      <td>${a.reason}</td>
      <td><button class="deleteBtn" onclick="deleteItem(arrests,${a.id},renderArrests)">X</button></td>
    </tr>`;
  });
}

/* CHAT */
const chatRef = db.ref("rockfordChat");

function sendMessage(){
  const text=document.getElementById("chatInput").value.trim();
  if(!text)return;

  chatRef.push({ user:currentUser, message:text });
  document.getElementById("chatInput").value="";
}

chatRef.on("child_added", snapshot=>{
  const data=snapshot.val();
  messages.innerHTML+=`<div><b>${data.user}:</b> ${data.message}</div>`;
  messages.scrollTop=messages.scrollHeight;
});
</script>

</body>
</html>
