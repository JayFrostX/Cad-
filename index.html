<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Rockford City Police CAD</title>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>

<style>
:root {
  --bg:#0f1720;
  --panel:#1f2a38;
  --text:white;
  --table:white;
}

.light {
  --bg:#f4f4f4;
  --panel:white;
  --text:black;
  --table:white;
}

body { margin:0; font-family:Arial; background:var(--bg); color:var(--text); }

/* LOGIN */
#loginPage {
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

#loginBox {
  background:var(--panel);
  padding:40px;
  width:380px;
  border-radius:12px;
  text-align:center;
}

/* Detailed Badge */
.badge {
  width:100px;
  height:120px;
  margin:0 auto 20px auto;
  background:gold;
  clip-path: polygon(50% 0%, 85% 20%, 100% 60%, 50% 100%, 0% 60%, 15% 20%);
  border:4px solid #b8860b;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  font-weight:bold;
  color:black;
  box-shadow:0 0 15px gold;
}

.badge span { font-size:12px; }

input, button { padding:10px; margin:5px 0; border-radius:6px; border:none; }

button { background:#1abc9c; color:white; cursor:pointer; }

#cadSystem { display:none; height:100vh; display:flex; }

#sidebar {
  width:260px;
  background:var(--panel);
  padding:15px;
}

#main { flex:1; display:flex; flex-direction:column; }

.section { flex:1; overflow:auto; padding:10px; display:none; }
.section.active { display:block; }

table { width:100%; border-collapse:collapse; background:var(--table); color:black; }
th, td { border:1px solid #ccc; padding:6px; }

.deleteBtn {
  background:red;
  color:white;
  padding:4px 8px;
  cursor:pointer;
}

/* CHAT */
#chatContainer { height:40%; display:flex; flex-direction:column; border-top:2px solid #ccc; }
#messages { flex:1; overflow-y:auto; padding:10px; background:#ddd; color:black; }
#chatInputArea { display:flex; }
#chatInput { flex:1; }
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginPage">
  <div id="loginBox">
    <div class="badge">
      <div>ROCKFORD</div>
      <span>POLICE</span>
      <span>CITY</span>
    </div>
    <h2>Rockford City CAD</h2>
    <input id="loginUser" placeholder="Username">
    <input type="password" placeholder="Password">
    <button onclick="login()">Login</button>
  </div>
</div>

<!-- CAD -->
<div id="cadSystem">
  <div id="sidebar">
    <h3>Rockford City</h3>
    <button onclick="showSection('calls')">Calls</button>
    <button onclick="showSection('units')">Units</button>
    <button onclick="showSection('warrants')">Warrants</button>
    <button onclick="showSection('arrests')">Arrests</button>
    <button onclick="toggleTheme()">Toggle Dark/Light</button>
  </div>

  <div id="main">

    <div id="calls" class="section active">
      <h3>Calls</h3>
      <button onclick="addCall()">Add</button>
      <table><thead><tr><th>ID</th><th>Type</th><th>Location</th><th>Delete</th></tr></thead>
      <tbody id="callsBody"></tbody></table>
    </div>

    <div id="units" class="section">
      <h3>Units</h3>
      <button onclick="addUnit()">Add</button>
      <table><thead><tr><th>ID</th><th>Name</th><th>Delete</th></tr></thead>
      <tbody id="unitsBody"></tbody></table>
    </div>

    <div id="warrants" class="section">
      <h3>Warrants</h3>
      <button onclick="addWarrant()">Add</button>
      <table><thead><tr><th>ID</th><th>Name</th><th>Reason</th><th>Delete</th></tr></thead>
      <tbody id="warrantsBody"></tbody></table>
    </div>

    <div id="arrests" class="section">
      <h3>Arrests</h3>
      <button onclick="addArrest()">Add</button>
      <table><thead><tr><th>ID</th><th>Name</th><th>Reason</th><th>Delete</th></tr></thead>
      <tbody id="arrestsBody"></tbody></table>
    </div>

    <!-- CHAT -->
    <div id="chatContainer">
      <div id="messages"></div>
      <div id="chatInputArea">
        <input id="chatInput" placeholder="Message...">
        <button onclick="sendMessage()">Send</button>
      </div>
    </div>

  </div>
</div>

<script>
/* FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "YOUR_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  databaseURL: "https://YOUR_PROJECT-default-rtdb.firebaseio.com",
  projectId: "YOUR_PROJECT"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* LOGIN */
let currentUser = "";

function login(){
  currentUser = document.getElementById("loginUser").value || "Guest";
  document.getElementById("loginPage").style.display="none";
  document.getElementById("cadSystem").style.display="flex";
}

/* THEME */
function toggleTheme(){
  document.body.classList.toggle("light");
}

/* SECTIONS */
function showSection(id){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

/* GENERIC ADD/DELETE */
function deleteItem(array, id, render){
  const index = array.findIndex(x=>x.id===id);
  if(index>-1){ array.splice(index,1); render(); }
}

/* CALLS */
let calls=[];
function addCall(){
  const type=prompt("Type:");
  const loc=prompt("Location:");
  if(!type||!loc)return;
  calls.push({id:Date.now(),type,loc});
  renderCalls();
}
function renderCalls(){
  callsBody.innerHTML="";
  calls.forEach(c=>{
    callsBody.innerHTML+=`<tr>
      <td>${c.id}</td>
      <td>${c.type}</td>
      <td>${c.loc}</td>
      <td><button class="deleteBtn" onclick="deleteItem(calls,${c.id},renderCalls)">X</button></td>
    </tr>`;
  });
}

/* UNITS */
let units=[];
function addUnit(){
  const name=prompt("Name:");
  if(!name)return;
  units.push({id:Date.now(),name});
  renderUnits();
}
function renderUnits(){
  unitsBody.innerHTML="";
  units.forEach(u=>{
    unitsBody.innerHTML+=`<tr>
      <td>${u.id}</td>
      <td>${u.name}</td>
      <td><button class="deleteBtn" onclick="deleteItem(units,${u.id},renderUnits)">X</button></td>
    </tr>`;
  });
}

/* WARRANTS */
let warrants=[];
function addWarrant(){
  const name=prompt("Name:");
  const reason=prompt("Reason:");
  if(!name||!reason)return;
  warrants.push({id:Date.now(),name,reason});
  renderWarrants();
}
function renderWarrants(){
  warrantsBody.innerHTML="";
  warrants.forEach(w=>{
    warrantsBody.innerHTML+=`<tr>
      <td>${w.id}</td>
      <td>${w.name}</td>
      <td>${w.reason}</td>
      <td><button class="deleteBtn" onclick="deleteItem(warrants,${w.id},renderWarrants)">X</button></td>
    </tr>`;
  });
}

/* ARRESTS */
let arrests=[];
function addArrest(){
  const name=prompt("Name:");
  const reason=prompt("Reason:");
  if(!name||!reason)return;
  arrests.push({id:Date.now(),name,reason});
  renderArrests();
}
function renderArrests(){
  arrestsBody.innerHTML="";
  arrests.forEach(a=>{
    arrestsBody.innerHTML+=`<tr>
      <td>${a.id}</td>
      <td>${a.name}</td>
      <td>${a.reason}</td>
      <td><button class="deleteBtn" onclick="deleteItem(arrests,${a.id},renderArrests)">X</button></td>
    </tr>`;
  });
}

/* CHAT (REAL-TIME FIXED) */
const chatRef = db.ref("rockfordChat");

function sendMessage(){
  const text=document.getElementById("chatInput").value.trim();
  if(!text)return;

  chatRef.push({
    user:currentUser,
    message:text
  });

  document.getElementById("chatInput").value="";
}

chatRef.on("child_added", snapshot=>{
  const data=snapshot.val();
  messages.innerHTML+=`<div><b>${data.user}:</b> ${data.message}</div>`;
  messages.scrollTop=messages.scrollHeight;
});
</script>
</body>
</html>
